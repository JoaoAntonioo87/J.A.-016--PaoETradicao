// HEADER MENU
const navHeader = Array(document.querySelector(".header-nav-links"));
const eventsHeaderMenu = ["click", "touch"];

if (window.screen.availWidth < 1000) {
  navHeader.forEach((element) => {
    eventsHeaderMenu.forEach((eventName) => {
      element.addEventListener(eventName, (event) => {
        element.classList.toggle("active");
        event.stopPropagation();
      });
    });

    eventsHeaderMenu.forEach((eventName) => {
      window.addEventListener(eventName, (event) => {
        if (Array.from(navHeader[0].classList).includes("active")) {
          navHeader[0].classList.remove("active");
        }
      });
    });
  });
}

// IMAGE INTRO
const imgsIntro = Array.from(document.querySelectorAll(".intro-img"));
const widthDevice = window.outerWidth;
let counter = 0;

setInterval(() => {
  if (counter < widthDevice * (imgsIntro.length - 1)) {
    counter = counter + widthDevice;
    imgsIntro.forEach((element) => {
      element.style.left = -counter + "px";
    });
  } else {
    imgsIntro.forEach((element) => {
      element.style.left = 0;
      counter = 0;
    });
  }
}, 2500);

// SLIDE ANIMATIONS
const slideElements = document.querySelectorAll("[data-slide]");

if ("requestIdleCallback" in window) {
  requestIdleCallback(() => {
    slideElements.forEach((element) => {
      if (window.outerHeight > element.offsetTop + 50) {
        element.dataset.slide = null;
        element.style.opacity = 1;
      }
      if (window.screen.availWidth > 1200) {
        if (
          element.dataset.slide === "left" ||
          element.dataset.slide === "right"
        ) {
          element.dataset.slide = "down";
        }
      }
    });
  });
}

// Debounce scroll listener
let scrollTimeout;
window.addEventListener(
  "scroll",
  () => {
    clearTimeout(scrollTimeout);
    scrollTimeout = setTimeout(() => {
      slideElements.forEach((element) => {
        if (window.outerHeight + window.scrollY > element.offsetTop + 200) {
          element.classList.add("active");
        }
      });
    }, 100);
  },
  { passive: true },
);

// HANDLE ACCORDION

const accordionElement = Array.from(
  document.querySelectorAll(".differences-card"),
);

accordionElement.forEach((element) => {
  element.addEventListener("click", () => {
    element.classList.toggle("active");
  });
});
